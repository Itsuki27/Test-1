<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="//cdn.datatables.net/2.1.8/css/dataTables.dataTables.min.css" rel="stylesheet" />
    <link href="//cdn.datatables.net/2.1.8/js/dataTables.min.js" rel="stylesheet" />
    <link href="~/Resources/Sidebar.css" rel="stylesheet" />
    @*<link href="~/Resources/Shared.css" rel="stylesheet" />*@
    @*<link href="~/Resources/Shared.js" />*@
    <link href="~/Content/Loader.css" rel="stylesheet" />

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=home" />
    <title>@ViewBag.Title - CRUD Application</title>

    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
</head>

<body style="background-color: whitesmoke">
    @if (Session["UserId"] != null)
    {
        <nav id="sidebar" class="sidebar-full">
            <ul>
                <li onclick="refresh()" id="icon-btn" class="logoRefresh mt-2">
                    <img alt="Icon" src="@Url.Content("~/Resources/imgLaptop.png")" class="img-fluid m-0" style="height: 24px; width: 21px" />
                    <span class="logo logoNone px-0">
                        <span class="navbar-brand font-monospace fw-bold m-0 ">CRUD APP</span>
                    </span>
                </li>
                <li class="active">
                    <a href="#" class="text-decoration-none nav-link text-light">
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M240-200h120v-240h240v240h120v-360L480-740 240-560v360Zm-80 80v-480l320-240 320 240v480H520v-240h-80v240H160Zm320-350Z" /></svg>
                        <span>DASHBOARD</span>
                    </a>
                </li>
                <li>
                    <a onclick="goUsers()">
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M560-564v-68q33-14 67.5-21t72.5-7q26 0 51 4t49 10v64q-24-9-48.5-13.5T700-600q-38 0-73 9.5T560-564Zm0 220v-68q33-14 67.5-21t72.5-7q26 0 51 4t49 10v64q-24-9-48.5-13.5T700-380q-38 0-73 9t-67 27Zm0-110v-68q33-14 67.5-21t72.5-7q26 0 51 4t49 10v64q-24-9-48.5-13.5T700-490q-38 0-73 9.5T560-454ZM260-320q47 0 91.5 10.5T440-278v-394q-41-24-87-36t-93-12q-36 0-71.5 7T120-692v396q35-12 69.5-18t70.5-6Zm260 42q44-21 88.5-31.5T700-320q36 0 70.5 6t69.5 18v-396q-33-14-68.5-21t-71.5-7q-47 0-93 12t-87 36v394Zm-40 118q-48-38-104-59t-116-21q-42 0-82.5 11T100-198q-21 11-40.5-1T40-234v-482q0-11 5.5-21T62-752q46-24 96-36t102-12q58 0 113.5 15T480-740q51-30 106.5-45T700-800q52 0 102 12t96 36q11 5 16.5 15t5.5 21v482q0 23-19.5 35t-40.5 1q-37-20-77.5-31T700-240q-60 0-116 21t-104 59ZM280-494Z" /></svg>
                        <span>USERS LIST</span>
                    </a>
                </li>
                <li>
                    <a onclick="goAudit()">
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M400-400h160v-80H400v80Zm0-120h320v-80H400v80Zm0-120h320v-80H400v80Zm-80 400q-33 0-56.5-23.5T240-320v-480q0-33 23.5-56.5T320-880h480q33 0 56.5 23.5T880-800v480q0 33-23.5 56.5T800-240H320Zm0-80h480v-480H320v480ZM160-80q-33 0-56.5-23.5T80-160v-560h80v560h560v80H160Zm160-720v480-480Z" /></svg>
                        <span>AUDIT LOG</span>
                    </a>
                </li>
                <li>
                    <a onclick="goDepts()">
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M120-120v-560h240v-80l120-120 120 120v240h240v400H120Zm80-80h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm240 320h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm240 480h80v-80h-80v80Zm0-160h80v-80h-80v80Z" /></svg>
                        <span>DEPARTMENTS</span>
                    </a>
                </li>
                <li>
                    <button onclick="toggleSub()" class="dropdown-btn ddClick">
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M234-276q51-39 114-61.5T480-360q69 0 132 22.5T726-276q35-41 54.5-93T800-480q0-133-93.5-226.5T480-800q-133 0-226.5 93.5T160-480q0 59 19.5 111t54.5 93Zm246-164q-59 0-99.5-40.5T340-580q0-59 40.5-99.5T480-720q59 0 99.5 40.5T620-580q0 59-40.5 99.5T480-440Zm0 360q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q53 0 100-15.5t86-44.5q-39-29-86-44.5T480-280q-53 0-100 15.5T294-220q39 29 86 44.5T480-160Zm0-360q26 0 43-17t17-43q0-26-17-43t-43-17q-26 0-43 17t-17 43q0 26 17 43t43 17Zm0-60Zm0 360Z" /></svg>
                        <span>ACCOUNT</span>
                        <span id="ddIcon">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M480-344 240-584l56-56 184 184 184-184 56 56-240 240Z" /></svg>
                        </span>
                    </button>
                    <ul class="sub-menu disappear">
                        <li class="col-12" onclick="goDetails()">
                            <span>@Html.ActionLink("VIEW PROFILE", "#", new { id = Session["UserId"] }, null)</span>
                        </li>
                        <li class="col-12" onclick="goEdit()">
                            <span>@Html.ActionLink("EDIT USER", "#", new { id = Session["UserId"] }, null)</span>
                        </li>
                        <li class="col-12">
                            <span>@Html.ActionLink("LOGOUT", "Logout", "Users", new { area = "" }, new { @class = "btLogout" })</span>
                        </li>
                    </ul>
                </li>

            </ul>

            @Html.ActionLink("USERS LIST", "Index", "Users", new { area = "" }, new { @class = "d-none btUsers" })
            @Html.ActionLink("AUDIT LOG", "AuditLog", "MOVEHISTs", new { area = "" }, new { @class = "d-none btAudit" })
            @Html.ActionLink("REPORTS", "Reports", "Users", new { area = "" }, new { @class = "d-none btReports" })
            @Html.ActionLink("DEPT LIST", "Index", "Depts", new { area = "" }, new { @class = "d-none btDepts" })

            @Html.ActionLink("VIEW PROFILE", "Details", "Users", new { id = Session["UserId"] }, new { @class = "d-none btDetails" })
            @Html.ActionLink("EDIT USER", "Edit", "Users", new { id = Session["UserId"] }, new { @class = "d-none btEdit" })

        </nav>

        <div class="d-flex flex-column">
            <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-dark d-flex py-4" style="background-color: green; height: 90px">
                <div class="container ms-2 col-md-11 d-flex flex-row">
                    <div>
                        <button onclick="toggleSideBar()" id="toggle-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#ffffff"><path d="M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z" /></svg>
                        </button>
                    </div>
                    <div class="collapse navbar-collapse d-sm-inline-flex flex-row justify-content-end col-12 d-flex">
                            <div class="my-auto mx-2 text-light">Welcome, <b>@Session["Username"].ToString()</b>!</div>
                            @Html.ActionLink("Logout", "Logout", "Users", new { area = "" }, new { @class = "nav-link mx-4 d-none hideLogout" })
                    </div>
                </div>
            </nav>

            @RenderBody()
            <hr />
            <footer class="d-flex flex-row px-4 mx-4">
                <p>&copy; @DateTime.Now.Year - CRUD APP</p>
            </footer>
        </div>

        <div class="loader hidden"></div>
    }
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>
    <link href="~/Resources/Sidebar.css" rel="stylesheet" />
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @Styles.Render("~/Content/fontawesome")
    @*@Scripts.Render("~/bundles/localjs")*@

    @RenderSection("scripts", required: false)

    <script>
    const subMenu = document.querySelector('.sub-menu')

        const toggleBtn = document.querySelector('#toggle-btn')
        const sideBar = document.querySelector('#sidebar')
        const logo = document.querySelector('.logo')

        const btLogout = document.querySelector('.btLogout')
        const hideLogout = document.querySelector('.hideLogout')
        const btUsers = document.querySelector('.btUsers')
        const btAudit = document.querySelector('.btAudit')
        const btReports = document.querySelector('.btReports')
        const btDepts = document.querySelector('.btDepts')
        const btDetails = document.querySelector('.btDetails')
        const btEdit = document.querySelector('.btEdit')

        var shown = false;
        var clicked = true;
        var sideShown = true;
        var deg0 = true;

        const ddIcon = document.querySelector('#ddIcon');

        if (shown == false) {
            window.onload = function () {
                subMenu.setAttribute('class', 'disappear');
            }
        }


        function toggleSub() {
            if (shown == true) {
                subMenu.setAttribute('class', 'disappear');
                //ddIcon.setAttribute('class', 'rotate');
                shown = false;
                ddIcon.removeAttribute('class', 'ddIcon180');
                ddIcon.setAttribute('class', 'ddIcon0');

                sideShown = false;
                toggleSideBar();
            } else {
                subMenu.setAttribute('class', 'show');
                //ddIcon.setAttribute('class', 'revert');
                shown = true;
                ddIcon.removeAttribute('class', 'ddIcon0');
                ddIcon.setAttribute('class', 'ddIcon180');

                sideShown = false;
                toggleSideBar();
            }

        }

        function toggleSideBar() {
            if (sideShown == true) {

                sideShown = false;
                logo.setAttribute('class', 'logoNone');
                sideBar.setAttribute('class', 'sidebar-small');

            } else {
                sideShown = true;
                logo.setAttribute('class', 'logo');
                sideBar.setAttribute('class', 'sidebar-full');
            }
        }

        sideBar.addEventListener('mouseover', function () {
            sideShown = false;
            toggleSideBar();
        });

        //if (clicked == false) {
        //    sideBar.addEventListener('mouseout', function () {
        //        sideShown = true;
        //        toggleSideBar();
        //    });
        //}


        btLogout.addEventListener('click', function (e) {
            e.preventDefault();
            var form = $(this).parents('form');
            Swal.fire({
                icon: 'question',
                title: 'Log out?',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Logout',
            }).then((result) => {
                if (result.value) {
                    hideLogout.click();
                }
            });
        })

        function goUsers() {
            btUsers.click();
            showLoading();
        }

        function goAudit() {
            btAudit.click();
            showLoading();
        }

        function goDepts() {
            btDepts.click();
            showLoading();
        }

        function goDetails() {
            btDetails.click();
            showLoading();
        }

        function goEdit() {
            btEdit.click();
            showLoading();
        }

    function showLoading() {
        event.preventDefault();
        $(".loader").removeClass("hidden");
        //setTimeout(function () {
        //    $("form").submit();
        //}, 1);
        return true;
        }

    //function navLoading() {
    //    event.preventDefault();
    //    $(".loader").removeClass("hidden");
    //    return true;
    //}

    </script>

    @*<script type="text/javascript">
        function preventBack() {
            window.history.forward();
        }
        setTimeout("preventBack()", 0);
        window.onunload = function () { null };
    </script>*@

</body>
</html>

<script src="~/Content/Loader.js"></script>

<script>
    function refresh() {
        window.location.reload()
    };
</script>
